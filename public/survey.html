<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="aviewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<!-- jquery -->
	<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
	<!-- Compiled and minified CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
	<!-- font awesome -->
	<script src="https://use.fontawesome.com/2d05a3f6a5.js"></script>
	<!-- internal css -->
	<!-- <link rel="stylesheet" type="text/css" href="assets/css/style.css"> -->
	<style type="text/css">
			#title {
				padding-left: 30px;
				font-size: 40px;
			}
			#apiFooter {
				padding: 30px 0px 10px 15px;
			}
			.apiButton {
				background-color: lightgray;
			}
			/*for this page specifically*/
			.right-gap {
				padding-right: 30px;
			}
			#surveyDiv {
				padding: 30px 30px 0px 30px;
			}
			#submitButton {
				padding-top: 20px;
			}
			/*modal*/
			.modal-mycss {
			    display: none; /* Hidden by default */
			    position: fixed; /* Stay in place */
			    z-index: 1; /* Sit on top */
			    left: 20%;
			    top: 10%;
			    width: 70%; /* Full width */
			    height: 50%; /* Full height */
			    overflow: auto; /* Enable scroll if needed */
			    background-color: #F6A2AD;
			    padding: 10px;
			}
			/* The Close Button */
			.close-mycss {
			    color: #aaa;
			    float: right;
			    margin-right: 30px;
			    font-size: 28px;
			    font-weight: bold;
			}

		</style>
</head>

<body>
	<div class="container">
		<nav>
			<div class="nav-wrapper header">
				<a href="#" id="title" class="brand-logo"><i class="fa fa-facebook-official"></i>Survey</a>
				<ul id="nav-mobile" class="right hide-on-med-and-down">
					<li><a href="/" class="valign-wrapper waves-effect waves-light btn-large"><span class="fa fa-home"></span></a></li>
				</ul>
				</ul>
			</div>
		</nav>

		<div id="surveyDiv">
			<form method="POST" role="form">
				<div class="input-field col s6">
					<input id="inputName" type="text" class="validate">
					<label for="inputName">Name:</label>
				</div>
				<div class="input-field col s6">
					<input id="inputPicture" type="text" class="validate">
					<label for="inputPicture">Picture (url):</label>
				</div>
				<table>
					<col width="40%">
  					<col width="60%" padding-left="20px">
					<thead>
						<tr>
							<th>Question</th>
							<th>Answer // 1 (strongly disagree) to 5 (strongly agree)</th>
						</tr>
					</thead>
					<tbody id="tableBody">
						<!-- <tr>
							<td>Your mind is always buzzing with unexplored ideas and plans.</td>
							<td>
								<p>
								  <input name="group1" type="radio" id="group1test1" value="1" />
								  <label class="group1 right-gap" for="group1test1">1</label>
								
								  <input name="group1" type="radio" id="group1test2" />
								  <label class="group1 right-gap" for="group1test2">2</label>
								
								  <input name="group1" type="radio" id="group1test3"  />
								  <label class="group1 right-gap" for="group1test3">3</label>
								
								  <input name="group1" type="radio" id="group1test4"/>
								  <label class="group1 right-gap" for="group1test4">4</label>

								  <input name="group1" type="radio" id="group1test5"/>
								  <label class="group1 right-gap" for="group1test5">5</label>
								</p>
							</td>
						</tr>
						<tr>
							<td>Generally speaking, you rely more on your experience than your imagination.</td>
							<td>
								<p>
								  <input name="group2" type="radio" id="group2test1" />
								  <label class="right-gap" for="group2test1">1</label>
								
								  <input name="group2" type="radio" id="group2test2" />
								  <label class="right-gap" for="group2test2">2</label>
								
								  <input name="group2" type="radio" id="group2test3"  />
								  <label class="right-gap" for="group2test3">3</label>
								
								  <input name="group2" type="radio" id="group2test4"/>
								  <label class="right-gap" for="group2test4">4</label>

								  <input name="group2" type="radio" id="group2test5"/>
								  <label class="right-gap" for="group2test5">5</label>
								</p>
							</td>
						</tr>
						<tr>
							<td>You find it easy to stay relaxed and focused even when there is some pressure.</td>
							<td>

								<p>
								  <input name="group3" type="radio" id="group3test1" />
								  <label class="right-gap" for="group3test1">1</label>
								
								  <input name="group3" type="radio" id="group3test2" />
								  <label class="right-gap" for="group3test2">2</label>
								
								  <input name="group3" type="radio" id="group3test3"  />
								  <label class="right-gap" for="group3test3">3</label>
								
								  <input name="group3" type="radio" id="group3test4"/>
								  <label class="right-gap" for="group3test4">4</label>

								  <input name="group3" type="radio" id="group3test5"/>
								  <label class="right-gap" for="group3test5">5</label>
								</p>

							</td>
						</tr>
						<tr>
							<td>You rarely do something just out of sheer curiosity.</td>
							<td>

								<p>
								  <input name="group4" type="radio" id="group4test1" />
								  <label class="right-gap" for="group4test1">1</label>
								
								  <input name="group4" type="radio" id="group4test2" />
								  <label class="right-gap" for="group4test2">2</label>
								
								  <input name="group4" type="radio" id="group4test3"  />
								  <label class="right-gap" for="group4test3">3</label>
								
								  <input name="group4" type="radio" id="group4test4"/>
								  <label class="right-gap" for="group4test4">4</label>

								  <input name="group4" type="radio" id="group4test5"/>
								  <label class="right-gap" for="group4test5">5</label>
								</p>

							</td>
						</tr>
						<tr>
							<td>People can rarely upset you.</td>
							<td>
								<p>
								  <input name="group5" type="radio" id="group5test1" />
								  <label class="right-gap" for="group5test1">1</label>
								
								  <input name="group5" type="radio" id="group5test2" />
								  <label class="right-gap" for="group5test2">2</label>
								
								  <input name="group5" type="radio" id="group5test3"  />
								  <label class="right-gap" for="group5test3">3</label>
								
								  <input name="group5" type="radio" id="group5test4"/>
								  <label class="right-gap" for="group5test4">4</label>

								  <input name="group5" type="radio" id="group5test5"/>
								  <label class="right-gap" for="group5test5">5</label>
								</p>
							</td>
						</tr>
						<tr>
							<td>It is often difficult for you to relate to other people’s feelings.</td>
							<td>

								<p>
								  <input name="group6" type="radio" id="group6test1" />
								  <label class="right-gap" for="group6test1">1</label>
								
								  <input name="group6" type="radio" id="group6test2" />
								  <label class="right-gap" for="group6test2">2</label>
								
								  <input name="group6" type="radio" id="group6test3"  />
								  <label class="right-gap" for="group6test3">3</label>
								
								  <input name="group6" type="radio" id="group6test4"/>
								  <label class="right-gap" for="group6test4">4</label>

								  <input name="group6" type="radio" id="group6test5"/>
								  <label class="right-gap" for="group6test5">5</label>
								</p>

							</td>
						</tr>
						<tr>
							<td>In a discussion, truth should be more important than people’s sensitivities.</td>
							<td>
								<p>
								  <input name="group7" type="radio" id="group7test1" />
								  <label class="right-gap" for="group7test1">1</label>
								
								  <input name="group7" type="radio" id="group7test2" />
								  <label class="right-gap" for="group7test2">2</label>
								
								  <input name="group7" type="radio" id="group7test3"  />
								  <label class="right-gap" for="group7test3">3</label>
								
								  <input name="group7" type="radio" id="group7test4"/>
								  <label class="right-gap" for="group7test4">4</label>

								  <input name="group7" type="radio" id="group7test5"/>
								  <label class="right-gap" for="group7test5">5</label>
								</p>
							</td>
						</tr>
						<tr>
							<td>You rarely get carried away by fantasies and ideas.</td>
							<td>
								<p>
								  <input name="group8" type="radio" id="group8test1" />
								  <label class="right-gap" for="group8test1">1</label>
								
								  <input name="group8" type="radio" id="group8test2" />
								  <label class="right-gap" for="group8test2">2</label>
								
								  <input name="group8" type="radio" id="group8test3"  />
								  <label class="right-gap" for="group8test3">3</label>
								
								  <input name="group8" type="radio" id="group8test4"/>
								  <label class="right-gap" for="group8test4">4</label>

								  <input name="group8" type="radio" id="group8test5"/>
								  <label class="right-gap" for="group8test5">5</label>
								</p>
							</td>
						</tr>
						<tr>
							<td>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</td>
							<td>

								<p>
								  <input name="group9" type="radio" id="group9test1" />
								  <label class="right-gap" for="group9test1">1</label>
								
								  <input name="group9" type="radio" id="group9test2" />
								  <label class="right-gap" for="group9test2">2</label>
								
								  <input name="group9" type="radio" id="group9test3"  />
								  <label class="right-gap" for="group9test3">3</label>
								
								  <input name="group9" type="radio" id="group9test4"/>
								  <label class="right-gap" for="group9test4">4</label>

								  <input name="group9" type="radio" id="group9test4]5"/>
								  <label class="right-gap" for="group9test5">5</label>
								</p>

							</td>
						</tr>
						<tr>
							<td>You feel more energetic after spending time with a group of people.</td>
							<td>

								<p>
								  <input name="group10" type="radio" id="group10test1" />
								  <label class="right-gap" for="group10test1">1</label>
								
								  <input name="group10" type="radio" id="group10test2" />
								  <label class="right-gap" for="group10test2">2</label>
								
								  <input name="group10" type="radio" id="group10test3"  />
								  <label class="right-gap" for="group10test3">3</label>
								
								  <input name="group10" type="radio" id="group10test4"/>
								  <label class="right-gap" for="group10test4">4</label>

								  <input name="group10" type="radio" id="group10test5"/>
								  <label class="right-gap" for="group10test5">5</label>
								</p>

							</td>
						</tr> -->
					</tbody>
				</table>
				<div id="submitButton">
					<button id="submit-btn" class="valign-wrapper waves-effect waves-light btn-large" type="submit">Submit</button>
				</div>
			</form>
		</div>
		<div id="apiFooter">
			<a class="waves-effect waves-light btn apiButton" href="/all">API Table Link</a>
			<a class="waves-effect waves-light btn apiButton" href="https://github.com/ccowen/Friend-Finder"> GutHub Repo</a>
		</div>

		<!-- modal --> 
		<div id="resultsModal" class="modal-mycss">

			<!-- Modal content -->
			<div class="modal-content-mycss">
			  <span class="close-mycss">&times;</span>
			  <h4 class="modalHeader">Here's your closest match!</h4>
			  <p class="flow-text">Score: <span id="modalLowestScore"></span>
			  	<br>Name: <span id="modalLowestScoreName"></span>
			  	<br>Picture: <span id='modalLowestScorePicture'>
			  	<br>
			  </p>
			</div>

		</div>
	</div>
	<!-- Compiled and minified JavaScript -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
	<script>
		$(document).ready(function() {

			var questions = [

				"Your mind is always buzzing with unexplored ideas and plans.",

				"Generally speaking, you rely more on your experience than your imagination.",

				"You find it easy to stay relaxed and focused even when there is some pressure.",

				"You rarely do something just out of sheer curiosity.",

				"People can rarely upset you.",

				"It is often difficult for you to relate to other people’s feelings.",

				"In a discussion, truth should be more important than people’s sensitivities.",

				"You rarely get carried away by fantasies and ideas.",

				"You think that everyone’s views should be respected regardless of whether they are supported by facts or not.",

				"You feel more energetic after spending time with a group of people.",
			];

			for (var i = 0; i < questions.length; i++) {
				$("#tableBody").append( "<tr>" +
					"<td>" + questions[i] + "</td>" +
					"<td>" +
						"<p>" +
						  "<input name='group" + [i + 1] + "' type='radio' id='group" + [i + 1] + "test1' value='1' />" +
						  "<label class='group" + [i + 1] + " right-gap' for='group" + [i + 1] + "test1'>1</label>" +

						  "<input name='group" + [i + 1] + "' type='radio' id='group" + [i + 1] + "test2' value='2' />" +
						  "<label class='group" + [i + 1] + " right-gap' for='group" + [i + 1] + "test2'>2</label>" +

						  "<input name='group" + [i + 1] + "' type='radio' id='group" + [i + 1] + "test3' value='3' />" +
						  "<label class='group" + [i + 1] + " right-gap' for='group" + [i + 1] + "test3'>3</label>" +

						  "<input name='group" + [i + 1] + "' type='radio' id='group" + [i + 1] + "test4' value='4' />" +
						  "<label class='group" + [i + 1] + " right-gap' for='group" + [i + 1] + "test4'>4</label>" +

						  "<input name='group" + [i + 1] + "' type='radio' id='group" + [i + 1] + "test5' value='5' />" +
						  "<label class='group" + [i + 1] + " right-gap' for='group" + [i + 1] + "test5'>5</label>" +

						"</p>" +
					"</td>" +
				"</tr>" );
			}

			// materialize functionality
		    $('select').material_select();

		    // Get the modal
    		var modal = document.getElementById('resultsModal');
    		// no modal yet
    		//modal.style.display = "none";

    		function subtractScores(input1, input2) {

    			var difference;

    			for (var i = 0; i <= 10; i++) {
    				difference += input1.scores[i] - input2.scores[2]
    			}

    			return parseInt(difference);
    		}

    		var lowestScore;
    		var lowestScoreArrayNumber;

    		function findLowestScore(newData, allData) {
    			// find the first difference, for now this is the lowest
    			var firstScore = subtractScores(newData, allData[0]);
    			// set the first score as the lowest score variable
    			lowestScore = firstScore;
    			lowestScoreArrayNumber = 0;

    			// compare all difference, see if there is a lower score
    			for (var i = 1; i <= data.length; i++) {
    				var compareScore = subtractScores(newData, allData[i]);

    				if (compareScore < lowestScore) {
    					lowestScore = compareScore;
    					lowestScoreArrayNumber = [i];
    				};

    			};

    			//after the loop is complete, the var lowestscore should be the lowest score and lowestScoreArrayNumber should identify the best match

    		};

		    // when the form is submitted
		    $("#submitButton").on("click", function(event) {
				event.preventDefault();
				var newForm = {
					"name": $("#inputName").val().trim(),
					"photo": $("#inputPicture").val().trim(),
					"scores": [ 
						$("input[name=group1]").val().trim(),
						$("input[name=group2]").val().trim(),
						$("input[name=group3]").val().trim(),
						$("input[name=group4]").val().trim(),
						$("input[name=group5]").val().trim(),
						$("input[name=group6]").val().trim(),
						$("input[name=group7]").val().trim(),
						$("input[name=group8]").val().trim(),
						$("input[name=group9]").val().trim(),
						$("input[name=group10]").val().trim()
					]

				//console.log(newForm);
					
				};

				$.post("/api/new", newForm)
				.done(function(data) {
					console.log(data);

					modal.style.display = "block";

					var span = document.getElementsByClassName("close-mycss")[0];
					span.onclick = function() {
				        modal.style.display = "none";
				    }

				});
			});

		});

	</script>
</body>

</html>